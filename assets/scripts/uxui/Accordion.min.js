import{createFormItem as e,isNodeDOM as t}from"../helpers/formgroup.min.js";let Accordion=function(){let c=this;return c.init=({id:e,...t})=>{let n=document.querySelector(`#${e}`);return n?c.collectAccordion({id:e,...t}):n=c.createAccordion({id:e,...t}),n},c.collectAccordion=({id:e,onlyAccordionOpen:t,...n})=>{let o=document.querySelector(`#${e}`),r=o.querySelectorAll(".accordion__control"),i=o.querySelectorAll(".accordion__item.active");r&&Array.from(r).map(e=>{let n=e.classList[0];e.onclick=e=>c.openAccordionItem({e,onlyAccordionOpen:t,btnClass:n})}),i&&Array.from(i).map(e=>{let t=e.querySelector(".accordion__content");t.style.maxHeight=c.getHeightChildrenInContent({itemContent:t})+"px"})},c.createAccordion=({id:t,...n})=>e({tag:"div",className:"accordion",id:t||"",children:[...c.createAccordionChilren(n)]}),c.createAccordionChilren=({arrowButton:t,onlyAccordionOpen:n,accordions:o})=>o?o.map(({idAccordion:o,title:r,content:i},a)=>e({tag:"div",className:`accordion__item ${0===a?"active":""}`,id:o||"",children:[{tag:"h4",className:"accordion__heading",append:c.createHeading({idAccordion:o,title:r,arrowButton:t,onlyAccordionOpen:n}),target:o},{tag:"div",className:"accordion__content",...c.createAccordionContent({content:i})}]})):[],c.createHeading=({title:t,arrowButton:n,onlyAccordionOpen:o})=>{let r="",i=""!=r?e({tag:"span",className:"accordion__button",innerHTML:r,onclick:e=>c.openAccordionItem({e,onlyAccordionOpen:o,btnClass:"accordion__heading"})}):"";return[e({tag:"span",className:"accordion__title",innerHTML:t||"Not a title",onclick:e=>c.openAccordionItem({e,onlyAccordionOpen:o,btnClass:"accordion__heading"})}),i]},c.openAccordionItem=({e,onlyAccordionOpen:t,btnClass:n})=>{e.preventDefault();let o=c.getExactlyButton({e,btnClass:n}).parentElement.target,r=document.querySelector(`#${o}`),i=r.className.indexOf("active"),a=r.querySelector(".accordion__content");if(-1!==i)a.style.maxHeight=null;else{if(t&&!0===t){let l=Array.from(document.querySelectorAll(".accordion__item")).find(e=>-1!==e.className.indexOf("active"));l&&(l.classList.remove("active"),l.querySelector(".accordion__content").style.maxHeight=null)}a.style.maxHeight=c.getHeightChildrenInContent({itemContent:a})+"px"}r.classList.toggle("active")},c.getExactlyButton=({e,btnClass:t})=>e.target.closest(`.${t}`),c.createAccordionContent=({content:e})=>t(e)?{append:e}:{innerHTML:e},c.getHeightChildrenInContent=({itemContent:e})=>0==e.children.length?0:Array.from(e.children).map(e=>e.clientHeight).reduce((e,t)=>e+t,0),c};export{Accordion};